## MS Graph API calls

In order to get the SPO connector working you need to use the MS Graph API. The API calls always require a token in the header of the request. In order to get this token you need a client_secret code from SharePoint. The client_secret has to be generated by someone who has administrator rights within the SharePoint environment. Underneath is a step by step procedure to get a client_secret as an administrator.

### Step 1: Logging into Azure Active Directory.

* Log into the [Azure Active Directory](https://login.microsoftonline.com/organizations/oauth2/v2.0/authorize?client_id=c44b4083-3bb0-49c1-b47d-974e53cbdf3c&response_mode=form_post&response_type=code+id_token&scope=https%3a%2f%2fmanagement.core.windows.net%2f%2fuser_impersonation+openid+email+profile&state=OpenIdConnect.AuthenticationProperties%3dLhjQ_eJwmrF6EaBOlmDHj-kEaoHMldWzaXqZrHipezY1vn9H1hJ7GIqge3G8jmfQx6aF4oDWHH9nfHQe8czNTgu9K96eeQ2T7WZeNSRbzPnuU-QdwJ7WQmeKkUktHgrjsSNeTIGKu05HGFs-UkffqB0-IqITYL34put7JdIrCqpWFj70WnPtBf5vthyNiY1WhexChul8nLrD42ky37ftHNitzmogf4l4FxV4tVfml3lLWG8wRtCblG1vQUSLL549KhzELPaZ_FhQvbWWhTqzK-_0Kelutt1gXc_-lgLLg2TJHIcgg9IKFqldq4prg6DuqyVJGaQhmCkdwWylT90W9sMxyfbWnrYH_atmDXZ59SYjqUyuKaO4QC5jhjUbSG6Cjo9anPrvAaeQmlDehwtcRwN33N5Wzu0LtDEXkZQXEMAUCM1gz28jJl4-VCNCiqxm&nonce=637188225024724540.ZDk2MjcwZWEtZTQxNS00NzZkLTlhNzQtYzYwNjgyZmFkZWVjMjVkNGY4ODctZTY0My00YWJlLTlhYTktNmIxMGQwMTk4YzA3&redirect_uri=https%3a%2f%2fportal.azure.com%2fsignin%2findex%2f%3ffeature.refreshtokenbinding%3dtrue%26feature.snivalidation%3dtrue%26feature.usemsallogin%3dtrue&site_id=501430&client-request-id=98127f69-c2a3-4809-8fed-85d57581b070&x-client-SKU=ID_NET&x-client-ver=1.0.40306.1554) with an administrator account.
* Click on View underneath Manage Azure Active Directory
* You should see a Home > *your organizations name* - Overview with a list of manage options on the left side of the page. 

### step 2: Registering a new app.
* Click on App registrations in the left menu.
* Click on new registration 
* Enter a name for the application (something like Xillio-Graph-API for example)
* Under supported account types choose accounts in any organizational directory and personal Microsoft accounts
* For our purposes you can skip the redirect URI
* Click on register, you should be redirected to an overview page of your newly created application with some information we will be needing later.

### step 3: Getting a client_secret
* In the left panel of the overview page of your application click on certificates and secrets.
* Click on new client secret
* Under description write something like Xillio-client-secret.
* Under expires click on never
* Click on add
* A new client-secret should have been added to under client secrets.
* The next step is crucial because the client_secret is only shown once! If you don't save it somewhere you will have to create an new client secret all over again. Save the client_secret.

### step 4: Configuration for Xillio-Insights-Graph-plugin
* In order for Xillio to make API-calls we need three pieces of information to get a token from the MS-Graph-API
* The client-secret which you saved in the previous step
* The Application (client) ID from the App overview page in step 2
* The Directory (tenant) ID from the App overview page in step 2

